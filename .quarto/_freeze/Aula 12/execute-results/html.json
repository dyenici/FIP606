{
  "hash": "a74b0377df7e2295137b8aa57d1944e6",
  "result": {
    "markdown": "---\ntitle: \"ANOVA com bloco\"\nformat: html\n---\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-1_eb14ebf8e0abfeb137eb23320e8482a0'}\n\n```{.r .cell-code}\nwarning(FALSE)\n\nlibrary(readxl)\nlibrary(tidyverse)\n\nfungicidas <- read_excel(\"dados-diversos.xlsx\", \"fungicida_campo\")\n```\n:::\n\n\n## Delineamenrto em Blocos Casualizado\nO delineamento em blocos casualizado (DBC) envolve os três princípios da experimentação: repetição, casualização e controle local. Neste caso, as condições locais não são homogêneas e podem ter efeito significativo sobre os tratamentos.\n\nCom o seguinte banco de dados é possível realizar a análise de variância (ANOVA) e testar as hipóteses sobre os tratamentos e blocos.\n\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-2_c4cddd0ac482eceb956b030f9a0d41ad'}\n\n```{.r .cell-code}\naov_fung <- aov(sev~trat+rep,data=\n                  fungicidas)\nsummary(aov_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)    \ntrat         7   7135  1019.3 287.661 <2e-16 ***\nrep          1     19    18.6   5.239 0.0316 *  \nResiduals   23     81     3.5                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# Mesmo sem significância, o bloco deve permanecer, pois o experimento foi montado em blocos.\n```\n:::\n\n\nChecando as premissas e comparando as médias.\n\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-3_d79154d273661a39cc9ab95d3ec4f883'}\n\n```{.r .cell-code}\nlibrary(performance)\nlibrary(DHARMa)\n\ncheck_normality(aov_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.230).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.484).\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(aov_fung))\n```\n\n::: {.cell-output-display}\n![](Aula-12_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\n\nmeans_fung <- emmeans(aov_fung, ~trat)\nlibrary(multcomp)\nlibrary(multcompView)\n\ncld(means_fung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n trat       emmean    SE df lower.CL upper.CL .group\n G            29.2 0.941 23     27.3     31.2  1    \n B            29.5 0.941 23     27.6     31.4  1    \n E            30.1 0.941 23     28.2     32.1  1    \n C            30.4 0.941 23     28.4     32.3  1    \n A            30.4 0.941 23     28.4     32.3  1    \n D            31.5 0.941 23     29.6     33.4  12   \n F            35.5 0.941 23     33.6     37.4   2   \n testemunha   75.8 0.941 23     73.8     77.7    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nplot(means_fung)+\n  coord_flip()+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Aula-12_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n### Trabalhando com parcela e subparcela\n\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-4_e82868c2f656eff2a76e76d55f00dd9e'}\n\n```{.r .cell-code}\n#Os híbridos são minha parcela, o método minha subparcela.\n\nmilho <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\naov_milho_bloco <- aov(index~factor(block)+hybrid*method+\n                         Error(factor(block)/hybrid/method), data=milho)\n\n# Método está dentro de híbrido, e os híbridos estão dentro do bloco.\n\nsummary(aov_milho_bloco)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nError: factor(block)\n              Df Sum Sq Mean Sq\nfactor(block)  3  592.2   197.4\n\nError: factor(block):hybrid\n          Df Sum Sq Mean Sq F value Pr(>F)  \nhybrid     5  974.2  194.84    3.14 0.0389 *\nResiduals 15  930.9   62.06                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: factor(block):hybrid:method\n              Df Sum Sq Mean Sq F value Pr(>F)  \nmethod         1  79.61   79.61   4.726 0.0433 *\nhybrid:method  5 265.28   53.06   3.150 0.0324 *\nResiduals     18 303.18   16.84                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Atualizando os blocos para fatores\n### Pacote \"lme4\"\nAjustar modelos de efeitos mistos lineares e lineares generalizados. Os modelos e seus componentes são representados usando classes e métodos S4.\n\n### Função \"lmer\"\nGerar um componente aleatório que é específico a cada indivíduo, de modo que podemos ter, para cada um, um intercepto e uma inclinação distintas. \n\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-5_12f02dd63ea3f0c0010842ece5c3a50c'}\n\n```{.r .cell-code}\nlibrary(lme4)\n\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(index~block+hybrid*method+\n               (1|block/hybrid), data=milho)\nanova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n              npar  Sum Sq Mean Sq F value\nblock            3   5.376   1.792  0.1064\nhybrid           5 264.420  52.884  3.1397\nmethod           1  79.606  79.606  4.7262\nhybrid:method    5 265.281  53.056  3.1500\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.621).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n\n```{.r .cell-code}\n#anova com letra \"a\" não aparece p valor.\n```\n:::\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-6_38254e3955fb4de27f2b87af5cfd189e'}\n\n```{.r .cell-code}\n#Anova com \"A\" é outra função - nessa aparece o p valor - associada ao pacote \"car\"\n\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(index~block+hybrid*method+\n               (1|block/hybrid), data=milho)\nlibrary(car)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nblock          0.3192  3   0.956380   \nhybrid        15.6987  5   0.007759 **\nmethod         4.7262  1   0.029706 * \nhybrid:method 15.7498  5   0.007596 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.621).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n:::\n:::\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-7_44b16e747779c3855e7171d12e8671f0'}\n\n```{.r .cell-code}\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(sqrt(index)~block+hybrid*method+\n               (1|block/hybrid), data=milho)\nlibrary(car)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nblock          0.0764  3   0.994506   \nhybrid        15.4171  5   0.008721 **\nmethod         3.9239  1   0.047605 * \nhybrid:method 13.3025  5   0.020703 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.422).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n:::\n:::\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-8_4c0ac55cff41cb5cf54904732cc82252'}\n\n```{.r .cell-code}\nmeans_mix2 <- emmeans (mix2, ~hybrid|method)\nmeans_mix2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   5.00 1.17 5356     2.69     7.30\n 30F53 YH   4.95 1.17 5356     2.65     7.25\n 30K64      4.50 1.17 5356     2.20     6.81\n 30S31H     6.10 1.17 5356     3.79     8.40\n 30S31YH    5.63 1.17 5356     3.33     7.93\n BG7049H    4.40 1.17 5356     2.10     6.71\n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   4.94 1.17 5356     2.64     7.25\n 30F53 YH   5.10 1.17 5356     2.80     7.41\n 30K64      4.61 1.17 5356     2.31     6.91\n 30S31H     5.13 1.17 5356     2.83     7.43\n 30S31YH    5.14 1.17 5356     2.84     7.44\n BG7049H    4.37 1.17 5356     2.07     6.67\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(means_mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.40 1.17 5356     2.10     6.71  1    \n 30K64      4.50 1.17 5356     2.20     6.81  1    \n 30F53 YH   4.95 1.17 5356     2.65     7.25  12   \n 30F53 HX   5.00 1.17 5356     2.69     7.30  12   \n 30S31YH    5.63 1.17 5356     3.33     7.93  12   \n 30S31H     6.10 1.17 5356     3.79     8.40   2   \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.37 1.17 5356     2.07     6.67  1    \n 30K64      4.61 1.17 5356     2.31     6.91  1    \n 30F53 HX   4.94 1.17 5356     2.64     7.25  1    \n 30F53 YH   5.10 1.17 5356     2.80     7.41  1    \n 30S31H     5.13 1.17 5356     2.83     7.43  1    \n 30S31YH    5.14 1.17 5356     2.84     7.44  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula-12_cache/html/unnamed-chunk-9_fb1b0ff5edf0ca1614fcae52c48bd4fb'}\n\n```{.r .cell-code}\nmeans_mix2 <- emmeans (mix2, ~method|hybrid)\nmeans_mix2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL\n pin      5.00 1.17 5356     2.69     7.30\n silk     4.94 1.17 5356     2.64     7.25\n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL\n pin      4.95 1.17 5356     2.65     7.25\n silk     5.10 1.17 5356     2.80     7.41\n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL\n pin      4.50 1.17 5356     2.20     6.81\n silk     4.61 1.17 5356     2.31     6.91\n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL\n pin      6.10 1.17 5356     3.79     8.40\n silk     5.13 1.17 5356     2.83     7.43\n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL\n pin      5.63 1.17 5356     3.33     7.93\n silk     5.14 1.17 5356     2.84     7.44\n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL\n pin      4.40 1.17 5356     2.10     6.71\n silk     4.37 1.17 5356     2.07     6.67\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(means_mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     4.94 1.17 5356     2.64     7.25  1    \n pin      5.00 1.17 5356     2.69     7.30  1    \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      4.95 1.17 5356     2.65     7.25  1    \n silk     5.10 1.17 5356     2.80     7.41  1    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n pin      4.50 1.17 5356     2.20     6.81  1    \n silk     4.61 1.17 5356     2.31     6.91  1    \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     5.13 1.17 5356     2.83     7.43  1    \n pin      6.10 1.17 5356     3.79     8.40   2   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     5.14 1.17 5356     2.84     7.44  1    \n pin      5.63 1.17 5356     3.33     7.93  1    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     4.37 1.17 5356     2.07     6.67  1    \n pin      4.40 1.17 5356     2.10     6.71  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}