{
  "hash": "bf828758f9ddafea1dd88ac17a23c827",
  "result": {
    "markdown": "---\ntitle: \"Regressão não linear e EC50\"\nformat: html\n---\n\n\n## Regressão não linear\nA regressão não linear é um método de localizar um modelo não linear do relacionamento entre a variável dependente e um conjunto de variáveis independentes. Diferentemente da regressão linear tradicional, que é restrita à estimativa de modelos lineares, a regressão não linear pode estimar modelos com relacionamentos arbitrários entre variáveis independentes e dependentes. Isso é feito usando algoritmos de estimação iterativos.\n\n\n::: {.cell hash='Aula-17_cache/html/unnamed-chunk-1_3f08aa039f1f34f90b7d922b16b1733e'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\n\ndat <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/15pCj0zljvd-TGECe67OMt6sa21xO8BqUgv4d-kU8qi8/edit#gid=0\")\n\noptions(scipen = 999)\n\ndat2<- dat |>\n  select(-Isolate, -Population) |> \n  group_by(Code, Year, Dose) |> \n  summarise(GC_mean=mean(GC))\n\nFGT152 <- dat2 |> \n  filter(Code ==\"FGT152\")\n\nFGT152 |> \n  ggplot(aes(Dose, GC_mean))+\n  geom_point()+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Aula-17_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndat2 |> ggplot(aes(Dose, GC_mean))+\n  geom_point()+\n  geom_line()+\n  facet_wrap(~Code)\n```\n\n::: {.cell-output-display}\n![](Aula-17_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n\n## EC50 com pacote DRC\nO controle efetivo para 50% de inibição do crescimento (EC 50) é uma estatística padrão para avaliar as relações dose-resposta. Muitos pacotes de software estatístico estão disponíveis para estimar as relações dose-resposta, mas, recentemente, um pacote de código aberto (“drc”) em R foi utilizado. Este pacote é altamente adaptável, tendo muitos modelos para descrever as relações dose-resposta e flexibilidade para descrever as relações horméticas e EC 50 absoluto e relativo . \n\nLeia mais em < https://apsjournals.apsnet.org/doi/full/10.1094/PDIS-06-17-0873-SR >\n\n\n::: {.cell hash='Aula-17_cache/html/unnamed-chunk-2_2afe83c482f55567e6fbd5748048ffc5'}\n\n```{.r .cell-code}\nlibrary(drc)\n\ndrc1 <- drm(GC_mean ~ Dose, data = FGT152,\n    fct = LL.3())\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](Aula-17_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  0.401905   0.053427  7.5225  0.001672 ** \nd:(Intercept) 47.540342   1.459890 32.5643 5.302e-06 ***\ne:(Intercept)  7.220130   2.340119  3.0854  0.036739 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.993805 (4 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nED (drc1, 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50   7.2201     2.3401\n```\n:::\n:::\n\n\n### Outro exemplo de modelo\n\n\n::: {.cell hash='Aula-17_cache/html/unnamed-chunk-3_4b005c449cec4467aeaf0c200c1d57c9'}\n\n```{.r .cell-code}\ndrc2 <- drm(GC_mean ~ Dose, data = FGT152,\n    fct = W1.3())\nplot(drc2)\n```\n\n::: {.cell-output-display}\n![](Aula-17_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(drc2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Weibull (type 1) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value   p-value    \nb:(Intercept)  0.28354    0.04760  5.9567  0.003987 ** \nd:(Intercept) 48.38112    2.09996 23.0390 2.103e-05 ***\ne:(Intercept) 30.12379   12.58003  2.3946  0.074796 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 2.680509 (4 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nED (drc2, 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50   8.2704     3.6719\n```\n:::\n:::\n\n::: {.cell hash='Aula-17_cache/html/unnamed-chunk-4_1a227c2606903d3ac3b81259334ec09c'}\n\n```{.r .cell-code}\nAIC (drc1, drc2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     df      AIC\ndrc1  4 33.60846\ndrc2  4 37.75192\n```\n:::\n:::\n\n::: {.cell hash='Aula-17_cache/html/unnamed-chunk-5_d623862323f2873d2b017a1ae4e3a08e'}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\n\ndf_ec50 <- estimate_EC50 (GC_mean ~ Dose,\n                          data = dat2,\n                          isolate_col = \"Code\",\n                          interval = \"delta\",\n                          fct = drc::LL.3())\n\ndf_ec50 |> \n  ggplot(aes(Estimate, reorder (ID, Estimate)))+\n  geom_point()+\n  geom_errorbar(aes(xmin=Lower,\n                    xmax=Upper, width = 0.1))+\n  xlim(0,30)\n```\n\n::: {.cell-output-display}\n![](Aula-17_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}