{"title":"Testes paramétricos e não paramétricos","markdown":{"yaml":{"title":"Testes paramétricos e não paramétricos","format":"html"},"headingText":"Introdução","containsRefs":false,"markdown":"\n\n\nNesta seção trataremos de formas de analisar dados em experimentos onde as causas da variação na resposta são controladas o máximo possível e o erro experimental minimizado. Veremos os tipos de análise de acordo com o número e tipo de variáveis independentes (níveis do fator) e também o número de tratamentos ou grupos a serem comparados. Iniciaremos primeiramente com os casos mais simples quanto ao número de grupos e iremos avançando conforme aumentamos a complexidade do experimento bem com algumas variações possíveis quanto ao número e tipo de variáveis resposta de interesse.\n\n### Dois tratamentos independentes\n\nUm pesquisador conduziu um experimento com o objetivo de avaliar o efeito de um micronutriente, o magnésio (Mg), adicionado na solução do solo cultivado com plantas de arroz, no manejo de uma doença fúngica. O experimento foi conduzido em delineamento inteiramente casualizado com 10 repetições, sendo cada repetição um vaso de planta. Um dos tratamentos é o chamado controle, ou testemunha, sem o suplemento mineral. O segundo é aquele com o suplemento do Mg na dose de 2 mM. Em cada uma das repetições foi obtido um valor médio do comprimento de lesões em um determinado tempo após a inoculação.\n\n### Preparo pré-análise\n\n```{r}\nlibrary(magrittr) # para usar pipes\nlibrary(ggplot2) # para gráficos\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(tidyr)\n```\n\n```{r}\ndata_mg <- read_excel(\"dados-diversos.xlsx\")\nhead(data_mg)\n```\n\nA maneira mais simples é visualizar, no caso de mais de 6 repetições, usando boxplots juntamente com os dados de cada repetição.\n\n```{r}\ndata_mg |> \n  ggplot(aes(trat, comp)) +\n  geom_boxplot(outlier.color = NA) +\n  geom_jitter(width = 0.1, shape = 1)\n```\n\nVamos obter estatísticas que descrevem o conjunto, seja a tendência central ou a dispersão dos dados. No caso, será a média, variância, desvio padrão, erro padrão e intervalo de confiança - esse último para inferência visual.\n\n```{r}\ndat2 <- data_mg |> \n  group_by(trat) |> \n  summarise(mean_comp = mean(comp),\n    sd_comp = sd(comp),\n    var_comp = var(comp),\n    n = n(),\n    se_comp = sd_comp / sqrt(n - 1),\n    ci = se_comp * qt(0.025, df = 9) # paramétrico\n  )\ndat2\n```\n\nJá podemos visualizar os dados com as estatísticas calculadas. Abaixo, as barras verticais represntam o intervalo de confiança 95%.\n\n```{r}\ndat2 %>%\n  ggplot(aes(trat, mean_comp)) +\n  geom_jitter(\n    data = data_mg, aes(trat, comp),\n    color = \"grey\",\n    width = 0.05\n  ) +\n  geom_errorbar(aes(\n    ymin = mean_comp - ci,\n    ymax = mean_comp + ci\n  ),\n  width = 0.05\n  ) +\n  geom_point(size = 3)\n```\n\nO conjunto está no formato largo, assim a variável resposta de interesse está apenas em uma coluna. Existem várias formas de separar em dois vetores os dados de resposta para cada tratamento. Uma delas é por meio da função `spread` do pacote `tidyr`, a qual coloca as respostas em duas colunas, uma para cada tratamento. Vamos criar o conjunto `data_mg2`.\n\n```{r}\ndata_mg2 <- data_mg %>%\n  spread(trat, comp)\ndata_mg2\n```\n\n## Análise inferencial\nUsando o conjunto original, vamos visualizar as respostas (tamanho da lesão) para cada tratamento, já que O `ggplot2` requer os dados no formato largo.\n\n```{r}\n# usando pipes\ndata_mg %>%\n  ggplot(aes(trat, comp)) +\n  geom_jitter(width = 0.1, height = 0) +\n  ylim(5, 20) # ajusta o eixo y para melhor visualização\n```\n\n### Homocedasticidade\nNo caso de dois grupos, a função que pode ser usada é a `var.test` do R. Vamos usar o formato largo e chamar os dois vetores do conjunto. Verifique o P-valor na saída da análise.\n\n```{r}\nattach(data_mg2) # vamos facilitar o uso dos vetores\nvar.test(Mg2, Ctrl)\n\n```\n\n### Normalidade\nA normalidade pode ser testada por meio de procedimentos visuais e testes específicos.\n\n```{r}\nshapiro.test(Mg2)\nshapiro.test(Ctrl)\n```\n\nAnálise visual da premissa de normalidade.\n\n```{r}\nqqnorm(Mg2)\nqqline(Mg2)\nqqnorm(Ctrl)\nqqline(Ctrl)\n```\n\n```{r}\n\nmagnesio3 <- data_mg %>%\n  group_by(trat) %>%\n  summarize(\n    mu = mean(comp),\n    sd = sd(comp),\n    n = length(comp),\n    se = sd / sqrt(n),\n    ciu = mu + (qt(0.025, df = n - 1) * se),\n    cil = mu - (qt(0.025, df = n - 1) * se)\n  )\n```\n\n### Intervalo de confiança\n\n```{r}\nmagnesio3 %>%\n  ggplot(aes(trat, mu, color = trat)) +\n  geom_point(size = 3) +\n  ylim(7,20)+\n  geom_errorbar(aes(min = cil, max = ciu), width = 0.05, size = 1) +\n  labs(x = \"Tratamento\", y = \"Valor\", title = \"Magnesium effect on lesion expansion\")\n```\n\n### Teste de hipótese\n\n```{r}\n\nt.test(Mg2, Ctrl, paired = F)\n```\n\n### Alternativas\nSe as premissas de normalidade não fossem atendidas, qual o teste que poderia ser usado? Nesse caso de dois grupos há duas possibilidades, uma é usar um teste não paramétrico ou um teste baseado em reamostragem (bootstrapping) dos dados, os quais independem do modelo de distribuição.\n\nUsando os mesmos dados podemos notar que o resultado é idêntico porém com P-valores diferentes.\n\n# Dois tratamentos dependentes\nUm experimento foi conduzido para avaliar o efeito do uso da escala na acurácia e precisão de avaliações visuais de severidade por avaliadores. A hipótese a ser testada foi que avaliações utilizando uma escala digramática como auxílio são mais acuradas do que sem o uso do auxílio. Dez avaliadores foram escolhidos aleatoriamente e fizeram duas avaliações cada. Cinco variáveis que compõe a medida da concordância das estimativas foram obtidas. Uma vez que as medidas foram repetidas no tempo para cada avaliador, as amostras são do tipo dependentes.\n\n## Preparo pré-análise\n\n```{r}\nescala <- read_excel(\"dados-diversos.xlsx\", \"escala\")\nhead(escala)\n```\n\n```{r}\nescala %>%\n  gather(component, statistics, 3:7) %>% # formato longo\n  ggplot(aes(reorder(assessment, statistics), statistics)) +\n  geom_jitter(width = 0.05) +\n  facet_wrap(~component, scales = \"free_y\")\n```\n\nPrepara os dados para análise. Cria os vetores de cada grupo para cada variável. Vamos fazer abaixo para acurácia.\n\n```{r}\n# arruma os dados\nescala2 <- select(escala, assessment, rater, acuracia)\nescala3 <- spread(escala2, assessment, acuracia)\n```\n\n### Premissas\n\n```{r}\n\n## homocedasticidade dois grupos\nattach(escala3)\nvar.test(Aided1, Unaided)\n\n## normalidade\nshapiro.test(Aided1)$p.value\nshapiro.test(Unaided)$p.value\nqqnorm(Aided1)\nqqline(Aided1)\nqqnorm(Unaided)\nqqline(Unaided)\n```\n\n### Análise inferencial\n\n```{r}\nescala4 <- summarize(group_by(escala2, assessment),\n  mu = mean(acuracia),\n  sd = sd(acuracia),\n  n = length(acuracia),\n  se = sd / sqrt(n),\n  ciu = mu + (qt(0.025, df = n - 1) * se),\n  cil = mu - (qt(0.025, df = n - 1) * se)\n)\n```\n\nVisualiza média e intervalo de confiança\n\n```{r}\nggplot(escala4, aes(assessment, mu)) +\n  geom_point(stat = \"identity\", size = 4) +\n  geom_errorbar(aes(min = cil, max = ciu),\n    width = .05\n  )\n```\n\nVisualiza cada avaliador\n\n```{r}\nggplot(escala2, aes(reorder(assessment, acuracia), acuracia, group = rater)) + geom_point(stat = \"identity\", size = 3, shape = 1) +\n  geom_line(size = 1, color = \"gray70\") + facet_wrap(~rater, nrow = 5)\n```\n\n### Teste t paramétrico\nNote que as amostras são pareadas - mesmo avaliador em dois tempos, portanto há dependência.\n\n```{r}\n## teste t para amostras pareadas\nt_escala <- t.test(escala3$Aided1, escala3$Unaided,\n  paired = TRUE,\n  var.equal = F\n)\n\nt_escala\n```\n\n## Teste não paramétrico\n### wilcox. test\nO teste T de Wilcoxon substitui o t de Student para amostras pareadas quando os dados não satisfazem as exigências deste último. Foi também desenvolvido por F. Wilcoxon em 1945 e baseia-se nos postos das diferenças intrapares. O teste de Wilcoxon (Wilcoxon Matched-Pairs; Wilcoxon signed-ranks test) é um método não-paramétrico para comparação de duas amostras pareadas. A princípio são calculados os valores numéricos da diferença entre cada par, sendo possível três condições: aumento (+), diminuição (-) ou igualdade (=). Uma vez calculadas todas as diferenças entre os valores obtidos para cada par de dados, essas diferenças são ordenadas pelo seu valor absoluto (sem considerar o sinal), substituindo-se então os valores originais pelo posto que ocupam na escala ordenada. O teste da hipótese de igualdade entre os grupos é baseado na soma dos postos das diferenças negativas e positivas.\n\n```{r}\nwilcox.test(escala3$Aided1, escala3$Unaided, paired = TRUE)\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula 9.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"superhero","title":"Testes paramétricos e não paramétricos"},"extensions":{"book":{"multiFile":true}}}}}