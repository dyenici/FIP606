---
title: "Gráficos, Tabelas e Mapas interativos"
format: html
---

## Pacote "Plotly"
O Plotly traduz de maneira fácil gráficos do ggplot2 para uma versão interativa na web ou cria uma visualização na web customizável diretamente do R via uma uma biblioteca de código aberto para JavaScript (plotly.js).

```{r}

warning(FALSE)

library(tidyverse)
library(plotly)
```

```{r}
mg <- read_csv("dados-diversos.csv")

mg |> 
  select (day, rep, severity) |> 
  group_by (day) |> 
  summarize(sev = mean (severity)) |> 
  ggplot (aes(day, sev))+
  geom_point()

```

```{r}
mg2 <- mg |> 
  select (day, rep, severity) |> 
  group_by (day) |> 
  summarize(sev = mean (severity))
```

```{r}
p <- mg2 |> 
  ggplot (aes(day, sev*100))+
  geom_line(color = "orange")+
  geom_point(size = 3, color = "orange")+
  scale_x_continuous(breaks = c(0, 7, 14, 21, 28, 35, 42, 49, 56, 63))+
  scale_y_continuous(n.breaks = 5, limits = c(0,100))+
  labs (x = "Time (days)", y = "Severity (%)", 
        title = "My first ggplot", subtitle = "D. Rodrigues", 
        caption = "Source: FIP 606")+
  theme_minimal()
```

```{r}
ggplotly (p)

plot_ly (mg2, x = ~ day, 
         y= ~sev, 
         type= 'scatter', 
         mode='dots')
```

## Mapas interativos

```{r}
library(rnaturalearth)
library(rnaturalearthhires)
library(r4pde)
library(tidyr)

sbr <- RustSoybean
sbr2 <- sbr|> separate (planting, into = c("year","month", "day"), sep= "-",
           remove= FALSE)

BRA <- ne_countries(country= "Brazil",
                    returnclass= "sf")
```

```{r}
ggplot(BRA)+
  geom_sf(color= "white",
          fill = "darkgreen")+
  theme_classic()

BRA <- ne_states(country= "Brazil",
                    returnclass= "sf")
MG <- BRA |> filter(name_en == "Minas Gerais")
```

```{r}
library(ggsn)

r <- ggplot(BRA)+
  geom_sf(color= "black",
          fill = "white")+
  geom_sf(data= MG, color = "black", fill= "darkblue")+
  geom_point(data=sbr, aes(longitude,latitude), alpha = 0.5)
  theme_void()

ggplotly (r)
```

```{r}
library(readxl)

survey <- read_excel ("dados-diversos.xlsx", "survey")

library(DT)

datatable(survey, 
          extensions = 'Buttons',
          options = list(
            dom = "Bfritp",
            buttons = c('copy', 'excel')))

```

## Pacote "Leaflet"
Uma das bibliotecas JavaScript mais populares para a criação de mapas interativos. Esse pacote permite gerar esses mapas de forma direta no R, para usar em documentos RMarkdown e Shiny.

```{r}
library(leaflet)

lat= -20.7474
long= -42.883
dat <- data.frame(lat, long)

dat |>  
  leaflet() |> 
  addTiles() |> 
  addMarkers()
```

```{r}
lat= -17.7211
long= -49.1081
dat2 <- data.frame(lat, long)

dat2 |>  
  leaflet() |> 
  addProviderTiles(providers$Esri.WorldImagery) |> 
  addMarkers()
```

