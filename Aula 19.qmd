---
title: "Gráficos, Mapas e Tabelas Interativos"
format: html
---
## Pacote "Plotly"

O pacote Plotly cria gráficos interativos da web a partir de gráficos ‘ggplot2’ e/ou uma interface personalizada para a biblioteca JavaScript (MITlicensed) ‘plotly.js’ inspirada na gramática dos gráficos.

### Gráficos Interativos

```{r}
warning(FALSE)

library(tidyverse)
library(plotly)
library(readxl)

mg <- read_csv("dados-diversos.csv")

mg |> 
  select (day, rep, severity) |> 
  group_by (day) |> 
  summarize(sev = mean (severity)) |> 
  ggplot (aes(day, sev))+
  geom_point()

####

mg2 <- mg |> 
  select (day, rep, severity) |> 
  group_by (day) |> 
  summarize(sev = mean (severity))

####

p <- mg2 |> 
  ggplot (aes(day, sev*100))+
  geom_line(color = "orange")+
  geom_point(size = 3, color = "orange")+
  scale_x_continuous(breaks = c(0, 7, 14, 21, 28, 35, 42, 49, 56, 63))+
  scale_x_continuous(n.breaks = 5, limits = c(0,100))+
  labs (x = "Time (days)", y = "Severity (%)", 
        title = "My first ggplot", subtitle = "D. Rodrigues", 
        caption = "Source: FIP 606")+
  theme_minimal()

####

ggplotly(p)

plot_ly(mg2, x = ~day, y=~sev, type=
          'scatter', mode='dots')

```

### Mapas Interativos

```{r}
library(rnaturalearth)
library(rnaturalearthhires)
library(r4pde)
library(tidyr)

sbr <- RustSoybean
sbr2 <- sbr|> separate (planting, into = c("year","month", "day"), sep= "-",
           remove= FALSE)

BRA <- ne_countries(country= "Brazil",
                    returnclass= "sf")
####

ggplot(BRA)+
  geom_sf(color= "white",
          fill = "darkgreen")+
  theme_classic()

BRA <- ne_states(country= "Brazil",
                    returnclass= "sf")
MG <- BRA |> filter(name_en == "Minas Gerais")

####

library(ggsn)

p <- ggplot(BRA)+
  geom_sf(color= "black",
          fill = "white")+
  geom_sf(data= MG, color = "black", fill= "darkblue")+
  geom_point(data=sbr, aes(longitude,latitude), alpha = 0.5)
  theme_void()

ggplotly(p)
```

## Pacote "DT"

O pacote DT fornece uma interface em JavaScript para a biblioteca DataTable. Os objetos de dados do R (matrizes ou data frames) podem ser exibidos como tabelas em páginas HTML, e o DataTables fornece filtragem, paginação, classificação e muitos outros recursos nas tabelas.

### Tabela Interativa

```{r}
survey <- read_excel ("dados-diversos.xlsx", "survey")

library(DT)
datatable(survey, 
          extensions = 'Buttons',
          options = list(
            dom = "Bfritp",
            buttons = c('copy', 'excel')))
```

## Pacote "Leaflet" para Mapas

Uma das bibliotecas JavaScript mais populares para a criação de mapas interativos. Esse pacote permite gerar esses mapas de forma direta no R, para usar em documentos RMarkdown e Shiny.

```{r}
library(leaflet)

lat= -20.7474
long= -42.883
dat <- data.frame(lat, long)

dat |>  
  leaflet() |> 
  addTiles() |> 
  addMarkers()
```

```{r}
lat= -17.7211
long= -49.1081
dat2 <- data.frame(lat, long)

dat2 |>  
  leaflet() |> 
  addProviderTiles(providers$Esri.WorldImagery) |> 
  addMarkers()
```

