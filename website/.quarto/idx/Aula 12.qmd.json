{"title":"ANOVA com bloco","markdown":{"yaml":{"title":"ANOVA com bloco","format":"html"},"headingText":"Delineamenrto em Blocos Casualizado","containsRefs":false,"markdown":"\n\n```{r}\nwarning(FALSE)\n\nlibrary(readxl)\nlibrary(tidyverse)\n\nfungicidas <- read_excel(\"dados-diversos.xlsx\", \"fungicida_campo\")\n```\n\nO delineamento em blocos casualizado (DBC) envolve os três princípios da experimentação: repetição, casualização e controle local. Neste caso, as condições locais não são homogêneas e podem ter efeito significativo sobre os tratamentos.\n\nCom o seguinte banco de dados é possível realizar a análise de variância (ANOVA) e testar as hipóteses sobre os tratamentos e blocos.\n\n```{r}\naov_fung <- aov(sev~trat+rep,data=\n                  fungicidas)\nsummary(aov_fung)\n\n# Mesmo sem significância, o bloco deve permanecer, pois o experimento foi montado em blocos.\n```\n\nChecando as premissas e comparando as médias.\n\n```{r}\nlibrary(performance)\nlibrary(DHARMa)\n\ncheck_normality(aov_fung)\ncheck_heteroscedasticity(aov_fung)\nplot(simulateResiduals(aov_fung))\n\nlibrary(emmeans)\n\nmeans_fung <- emmeans(aov_fung, ~trat)\nlibrary(multcomp)\nlibrary(multcompView)\n\ncld(means_fung)\n\nplot(means_fung)+\n  coord_flip()+\n  theme_minimal()\n```\n\n### Trabalhando com parcela e subparcela\n\n```{r}\n#Os híbridos são minha parcela, o método minha subparcela.\n\nmilho <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\naov_milho_bloco <- aov(index~factor(block)+hybrid*method+\n                         Error(factor(block)/hybrid/method), data=milho)\n\n# Método está dentro de híbrido, e os híbridos estão dentro do bloco.\n\nsummary(aov_milho_bloco)\n\n```\n\n## Atualizando os blocos para fatores\n### Pacote \"lme4\"\nAjustar modelos de efeitos mistos lineares e lineares generalizados. Os modelos e seus componentes são representados usando classes e métodos S4.\n\n### Função \"lmer\"\nGerar um componente aleatório que é específico a cada indivíduo, de modo que podemos ter, para cada um, um intercepto e uma inclinação distintas. \n\n```{r}\nlibrary(lme4)\n\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(index~block+hybrid*method+\n               (1|block/hybrid), data=milho)\nanova(mix2)\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\n\n#anova com letra \"a\" não aparece p valor.\n```\n\n```{r}\n#Anova com \"A\" é outra função - nessa aparece o p valor - associada ao pacote \"car\"\n\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(index~block+hybrid*method+\n               (1|block/hybrid), data=milho)\nlibrary(car)\nAnova(mix2)\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\n```\n\n```{r}\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(sqrt(index)~block+hybrid*method+\n               (1|block/hybrid), data=milho)\nlibrary(car)\nAnova(mix2)\ncheck_normality(mix2)\ncheck_heteroscedasticity(mix2)\n```\n\n```{r}\nmeans_mix2 <- emmeans (mix2, ~hybrid|method)\nmeans_mix2\ncld(means_mix2)\n```\n\n```{r}\nmeans_mix2 <- emmeans (mix2, ~method|hybrid)\nmeans_mix2\ncld(means_mix2)\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula 12.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"lux","title":"ANOVA com bloco"},"extensions":{"book":{"multiFile":true}}}}}