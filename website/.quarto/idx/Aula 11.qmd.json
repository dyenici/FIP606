{"title":"ANOVA Fatorial","markdown":{"yaml":{"title":"ANOVA Fatorial","format":"html"},"headingText":"ANOVA Fatorial","containsRefs":false,"markdown":"\nANOVA fatorial é usada quando há duas ou mais variáveis independentes. Cada um desses fatores pode ter vários níveis. ANOVA fatorial só pode ser usado no caso de um experimento fatorial completo, onde há uso de todas as permutações possíveis de fatores e seus níveis. Esta ANOVA não mede apenas a variável independente versus a independente, mas se os dois fatores afetam um ao outro. \n\n```{r}\n\n# Análise exploratória\n\nlibrary(readxl)\nlibrary(tidyverse)\n\ndat <- read_excel(\"dados-diversos.xlsx\", \"fungicida_vaso\")\n\ndat2 <- dat |> \n  mutate(inc = dis_sp/n_sp*100)\n\n# mutate()cria novas colunas que são funções de variáveis existentes. Essa função também pode modificar (se o nome for o mesmo de uma coluna existente) e excluir colunas (configurando seu valor como NULL).\n\ndat2 |> \n  ggplot(aes(x=treat,\n             y=inc)) +\n  geom_jitter(width = 0.1) +\n  facet_wrap(~ dose)\n```\n\nAplicação de ANOVA\n\n```{r}\nm1 <- aov(inc ~ treat*dose,\n          data = dat2)\nsummary(m1)\n\nlibrary(performance)\ncheck_normality(m1)\ncheck_heteroscedasticity(m1)\n\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n\n```\n\nOs dados não apresentam normalidade e homocedasticidade, partimos para a transformação.\n\n```{r}\nm2 <- aov(log(inc+0.5) ~ treat*dose,\n          data = dat2)\n\nlibrary(performance)\ncheck_normality(m2)\ncheck_heteroscedasticity(m2)\n\nlibrary(DHARMa)\nplot(simulateResiduals(m2))\n```\n\n\"Response\": trabalho com meus dados sem transformação.\n\n```{r}\n\n# Comparação de médias \"Tratamento em função da Dose\"\n\nlibrary(emmeans)\nmeans_m2 <- emmeans (m2, ~treat|dose,\n                     type=\"response\")\nmeans_m2\n\nlibrary(multcomp)\nlibrary(multcompView)\ncld(means_m2)\n\n```\n\n```{r}\n# Comparação de médias \"Dose em função do Tratamento\"\n\nlibrary(emmeans)\nmeans_m2 <- emmeans (m2, ~dose|treat,\n                     type=\"response\")\nmeans_m2\n\nlibrary(multcomp)\nlibrary(multcompView)\ncld(means_m2)\n```\n\n### cv.model\nObtém o coeficiente de variação do experimento obtido pelos modelos lm() ou aov().\n\n```{r}\nlibrary(agricolae)\ncv.model(m2)\n```\n\nOutro exemplo:\n\n```{r}\nmilho <- read_excel(\"dados-diversos.xlsx\", \"armazena\")\nmilho |> \n  filter(tempo==8) |> \n  ggplot(aes(factor(tipo),\n             peso_mil,\n             color=factor(umidade)))+\n  geom_jitter(width = 0.1)+\n  facet_wrap(~umidade)\n```\n\n```{r}\nmilho2 <- milho |> \n  filter(tempo==8)\n\nm2 <- aov(peso_mil~factor(tipo)\n          *factor(umidade), \n          data=milho2)\nsummary(m2)\n          \n```\n\n```{r}\nmilho3 <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\nm4 <- aov(yield~hybrid*method,\n          data=milho3)\nsummary(m4)\nplot(simulateResiduals(m4))\n```\n\n### pwpm\nEsta função apresenta resultados \"emmeans\" e comparações aos pares de forma compacta. Ele exibe uma matriz (ou matrizes) de estimativas, diferenças pareadas e valores de P.\n\n```{r}\nmilho3 <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\nm4 <- aov(yield~hybrid,\n          data=milho3)\nsummary(m4)\ncheck_heteroscedasticity(m4)\nmedias_m4 <- emmeans(m4,~hybrid)\nmedias_m4\ncld(medias_m4)\npwpm(medias_m4)\npwpp(medias_m4)\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula 11.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"superhero","title":"ANOVA Fatorial"},"extensions":{"book":{"multiFile":true}}}}}