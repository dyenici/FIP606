{
  "hash": "b8be438361c793125536ab09e5f64826",
  "result": {
    "markdown": "---\ntitle: \"ANOVA Fatorial\"\nformat: html\n---\n\n## ANOVA Fatorial\nANOVA fatorial é usada quando há duas ou mais variáveis independentes. Cada um desses fatores pode ter vários níveis. ANOVA fatorial só pode ser usado no caso de um experimento fatorial completo, onde há uso de todas as permutações possíveis de fatores e seus níveis. Esta ANOVA não mede apenas a variável independente versus a independente, mas se os dois fatores afetam um ao outro. \n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-1_21f4a783d645ec2d3d505b312a083d16'}\n\n```{.r .cell-code}\n# Análise exploratória\n\nlibrary(readxl)\nlibrary(tidyverse)\n\ndat <- read_excel(\"dados-diversos.xlsx\", \"fungicida_vaso\")\n\ndat2 <- dat |> \n  mutate(inc = dis_sp/n_sp*100)\n\n# mutate()cria novas colunas que são funções de variáveis existentes. Essa função também pode modificar (se o nome for o mesmo de uma coluna existente) e excluir colunas (configurando seu valor como NULL).\n\ndat2 |> \n  ggplot(aes(x=treat,\n             y=inc)) +\n  geom_jitter(width = 0.1) +\n  facet_wrap(~ dose)\n```\n\n::: {.cell-output-display}\n![](Aula-11_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nAplicação de ANOVA\n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-2_bd3ad58f7bf11c4eee179498f8730df0'}\n\n```{.r .cell-code}\nm1 <- aov(inc ~ treat*dose,\n          data = dat2)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ntreat        1  919.5   919.5   24.31 0.000151 ***\ndose         1  920.9   920.9   24.34 0.000150 ***\ntreat:dose   1  747.7   747.7   19.76 0.000407 ***\nResiduals   16  605.3    37.8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.018).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula-11_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nOs dados não apresentam normalidade e homocedasticidade, partimos para a transformação.\n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-3_a48a375e4e0a610a8a1b92de311bf53d'}\n\n```{.r .cell-code}\nm2 <- aov(log(inc+0.5) ~ treat*dose,\n          data = dat2)\n\nlibrary(performance)\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.050).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.180).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m2))\n```\n\n::: {.cell-output-display}\n![](Aula-11_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\"Response\": trabalho com meus dados sem transformação.\n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-4_ed4532059fbcb396cf4554cd36a3037e'}\n\n```{.r .cell-code}\n# Comparação de médias \"Tratamento em função da Dose\"\n\nlibrary(emmeans)\nmeans_m2 <- emmeans (m2, ~treat|dose,\n                     type=\"response\")\nmeans_m2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        response     SE df lower.CL upper.CL\n Ionic liquid    27.05 11.847 16   10.570    68.05\n Tebuconazole     1.21  0.737 16    0.188     3.76\n\ndose = 2.0:\n treat        response     SE df lower.CL upper.CL\n Ionic liquid     3.10  1.412 16    1.065     7.77\n Tebuconazole     1.42  0.925 16    0.194     4.83\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log(mu + 0.5) scale \n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(multcompView)\ncld(means_m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndose = 0.5:\n treat        response     SE df lower.CL upper.CL .group\n Tebuconazole     1.21  0.737 16    0.188     3.76  1    \n Ionic liquid    27.05 11.847 16   10.570    68.05   2   \n\ndose = 2.0:\n treat        response     SE df lower.CL upper.CL .group\n Tebuconazole     1.42  0.925 16    0.194     4.83  1    \n Ionic liquid     3.10  1.412 16    1.065     7.77  1    \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log(mu + 0.5) scale \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-5_93eeb1eb3728d566279ae69d5a92d9e0'}\n\n```{.r .cell-code}\n# Comparação de médias \"Dose em função do Tratamento\"\n\nlibrary(emmeans)\nmeans_m2 <- emmeans (m2, ~dose|treat,\n                     type=\"response\")\nmeans_m2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose response     SE df lower.CL upper.CL\n  0.5    27.05 11.847 16   10.570    68.05\n  2.0     3.10  1.412 16    1.065     7.77\n\ntreat = Tebuconazole:\n dose response     SE df lower.CL upper.CL\n  0.5     1.21  0.737 16    0.188     3.76\n  2.0     1.42  0.925 16    0.194     4.83\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log(mu + 0.5) scale \n```\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(multcompView)\ncld(means_m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntreat = Ionic liquid:\n dose response     SE df lower.CL upper.CL .group\n  2.0     3.10  1.412 16    1.065     7.77  1    \n  0.5    27.05 11.847 16   10.570    68.05   2   \n\ntreat = Tebuconazole:\n dose response     SE df lower.CL upper.CL .group\n  0.5     1.21  0.737 16    0.188     3.76  1    \n  2.0     1.42  0.925 16    0.194     4.83  1    \n\nConfidence level used: 0.95 \nIntervals are back-transformed from the log(mu + 0.5) scale \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n### cv.model\nObtém o coeficiente de variação do experimento obtido pelos modelos lm() ou aov().\n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-6_6ec114448c9304fda016927570a8ec07'}\n\n```{.r .cell-code}\nlibrary(agricolae)\ncv.model(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 65.04818\n```\n:::\n:::\n\n\nOutro exemplo:\n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-7_f784742d520775a4cb37caf286054c97'}\n\n```{.r .cell-code}\nmilho <- read_excel(\"dados-diversos.xlsx\", \"armazena\")\nmilho |> \n  filter(tempo==8) |> \n  ggplot(aes(factor(tipo),\n             peso_mil,\n             color=factor(umidade)))+\n  geom_jitter(width = 0.1)+\n  facet_wrap(~umidade)\n```\n\n::: {.cell-output-display}\n![](Aula-11_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-8_41da33ec79fc45aced784f9fdbe6a7e2'}\n\n```{.r .cell-code}\nmilho2 <- milho |> \n  filter(tempo==8)\n\nm2 <- aov(peso_mil~factor(tipo)\n          *factor(umidade), \n          data=milho2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                             Df Sum Sq Mean Sq F value   Pr(>F)    \nfactor(tipo)                  1  11215   11215  2375.8 3.64e-15 ***\nfactor(umidade)               2  42814   21407  4534.8  < 2e-16 ***\nfactor(tipo):factor(umidade)  2   2329    1165   246.7 1.79e-10 ***\nResiduals                    12     57       5                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-9_656e4cf862ce610ee6af1d2a70aad257'}\n\n```{.r .cell-code}\nmilho3 <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\nm4 <- aov(yield~hybrid*method,\n          data=milho3)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid         5 105876446 21175289   8.312 2.66e-05 ***\nmethod         1     42951    42951   0.017    0.897    \nhybrid:method  5  10619453  2123891   0.834    0.534    \nResiduals     36  91709593  2547489                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output-display}\n![](Aula-11_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### pwpm\nEsta função apresenta resultados \"emmeans\" e comparações aos pares de forma compacta. Ele exibe uma matriz (ou matrizes) de estimativas, diferenças pareadas e valores de P.\n\n\n::: {.cell hash='Aula-11_cache/html/unnamed-chunk-10_8dcf47bad2b9e0f81ee5eb40bf64cb34'}\n\n```{.r .cell-code}\nmilho3 <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\nm4 <- aov(yield~hybrid,\n          data=milho3)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid       5 105876446 21175289   8.688 1.02e-05 ***\nResiduals   42 102371996  2437428                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.763).\n```\n:::\n\n```{.r .cell-code}\nmedias_m4 <- emmeans(m4,~hybrid)\nmedias_m4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n hybrid   emmean  SE df lower.CL upper.CL\n 30F53 HX  10598 552 42     9484    11712\n 30F53 YH   9309 552 42     8195    10423\n 30K64     11018 552 42     9904    12132\n 30S31H     8652 552 42     7538     9765\n 30S31YH    8056 552 42     6942     9170\n BG7049H   12402 552 42    11288    13516\n\nConfidence level used: 0.95 \n```\n:::\n\n```{.r .cell-code}\ncld(medias_m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n hybrid   emmean  SE df lower.CL upper.CL .group\n 30S31YH    8056 552 42     6942     9170  1    \n 30S31H     8652 552 42     7538     9765  12   \n 30F53 YH   9309 552 42     8195    10423  123  \n 30F53 HX  10598 552 42     9484    11712   234 \n 30K64     11018 552 42     9904    12132    34 \n BG7049H   12402 552 42    11288    13516     4 \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\npwpm(medias_m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         30F53 HX 30F53 YH   30K64  30S31H 30S31YH BG7049H\n30F53 HX  [10598]   0.5709  0.9942  0.1494  0.0254  0.2125\n30F53 YH     1288  [ 9309]  0.2643  0.9576  0.5999  0.0036\n30K64        -420    -1709 [11018]  0.0447  0.0059  0.4938\n30S31H       1946      658    2366 [ 8652]  0.9723  0.0003\n30S31YH      2541     1253    2962     595 [ 8056]  <.0001\nBG7049H     -1804    -3092   -1384   -3750   -4345 [12402]\n\nRow and column labels: hybrid\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\npwpp(medias_m4)\n```\n\n::: {.cell-output-display}\n![](Aula-11_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}