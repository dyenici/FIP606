{
  "hash": "6f1d439cf8ca81d27192398ab6593a35",
  "result": {
    "markdown": "---\ntitle: \"Regressão Linear\"\nformat: html\n---\n\n\n## Regressão linear\nA regressão linear é uma técnica de análise de dados que prevê o valor de dados desconhecidos usando outro valor de dados relacionado e conhecido. Ele modela matematicamente a variável desconhecida ou dependente e a variável conhecida ou independente como uma equação linear. \n\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-1_9e336e1c62e3d971c437cfde8eca1c49'}\n\n```{.r .cell-code}\nwarning(FALSE)\n\nlibrary(tidyverse)\nlibrary(readxl)\n\nestande <- read_excel(\"dados-diversos.xlsx\",\"estande\")\n\nestande |> ggplot (aes(trat,nplants))+\n  geom_point()+\n  facet_wrap(~exp)+\n  ylim(0,max(estande$nplants))+\n  geom_smooth(se=F)\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n### \"group_by\": seleciona apenas a variável de interesse\n\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-2_fbfe3dfefc44f838342447c901fb6bf5'}\n\n```{.r .cell-code}\nestande2 <- estande |> \n  filter(exp ==2) |> \n  group_by(trat) |> \n  summarise(mean_nplants =\n              mean(nplants))\n\nestande2 |> ggplot(aes(trat, mean_nplants))+\n  geom_point()+\n  #geom_line()+\n  geom_smooth(se = F,formula = y ~ poly(x,2), method = \"lm\")+\n  annotate (geom =\"text\",\n           x=25, y=70,\n           label= \"y=66.3 - 1.777x + //////0.0222x\n           R² = 0.88\")\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#R² - coeficiente de determinação (regressão linear)\n```\n:::\n\n\n### Akaike Information Criterion (AIC) \nPermite que você teste o quão bem seu modelo se ajusta ao conjunto de dados sem sobreajustá-lo. A pontuação AIC recompensa os modelos que atingem uma alta pontuação de qualidade de ajuste e os penaliza se eles se tornarem excessivamente complexos. Por si só, a pontuação AIC não é muito útil, a menos que seja comparada com a pontuação AIC de um modelo concorrente. Espera-se que o modelo com a pontuação AIC mais baixa atinja um equilíbrio superior entre sua capacidade de ajustar o conjunto de dados e sua capacidade de evitar o ajuste excessivo do conjunto de dados.\n\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-3_1628190e7b29c914002750b05623acf9'}\n\n```{.r .cell-code}\nestande2 <- estande2 |> \n  mutate(trat2=trat^2)\n\nm1 <- lm(mean_nplants ~ trat,\n         data=estande2)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mean_nplants ~ trat, data = estande2)\n\nResiduals:\n     1      2      3      4      5      6 \n12.764 -2.134 -6.782 -3.327 -4.669  4.147 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     4.5505  13.402 0.000179 ***\ntrat         -0.7007     0.2012  -3.483 0.025294 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.117 on 4 degrees of freedom\nMultiple R-squared:  0.752,\tAdjusted R-squared:   0.69 \nF-statistic: 12.13 on 1 and 4 DF,  p-value: 0.02529\n```\n:::\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nm2 <- lm(mean_nplants ~trat + trat2,\n         data = estande2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mean_nplants ~ trat + trat2, data = estande2)\n\nResiduals:\n      1       2       3       4       5       6 \n 7.4484 -4.4200 -6.4386  1.0739  3.0474 -0.7111 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.70800  14.083 0.000776 ***\ntrat        -1.77720    0.62263  -2.854 0.064878 .  \ntrat2        0.02223    0.01242   1.790 0.171344    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.517 on 3 degrees of freedom\nMultiple R-squared:  0.8801,\tAdjusted R-squared:  0.8001 \nF-statistic: 11.01 on 2 and 3 DF,  p-value: 0.04152\n```\n:::\n\n```{.r .cell-code}\nAIC(m1,m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   df      AIC\nm1  3 45.72200\nm2  4 43.36151\n```\n:::\n:::\n\n\n## Duas variáveis resposta\nA relação é com duas variáveis respostas - teste de associação;\nAnálise de correlação - coeficiente de correlação (coef. de Pearson);\nR é sempre maior que R².\n\n### Coeficiente de Pearson\nO coeficiente de correlação de Pearson é um teste que mede a relação estatística entre duas variáveis contínuas. Se a associação entre os elementos não for linear, o coeficiente não será representado adequadamente.\n\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-4_5ade33c65e251f102a850f407ca0178b'}\n\n```{.r .cell-code}\nmofo<- read_excel(\"dados-diversos.xlsx\", \"mofo\")\n\nmofo |>\n  ggplot(aes(inc, yld))+\n  geom_point()+\n  geom_smooth(se=F, method= \"lm\")+\n  facet_wrap(~study)\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### cor.test\nEsta função realiza um teste de correlação entre duas variáveis. \n\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-5_10dc645df916958b8a377d5c5a23b7af'}\n\n```{.r .cell-code}\n#Experimento 1\n\nmofo1 <- mofo |> \n  filter (study ==1)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     1     1    76  2194  2265\n 2     1     2    53  1663  2618\n 3     1     3    42  1313  2554\n 4     1     4    37  1177  2632\n 5     1     5    29   753  2820\n 6     1     6    42  1343  2799\n 7     1     7    55  1519  2503\n 8     1     8    40   516  2967\n 9     1     9    26   643  2965\n10     1    10    18   400  3088\n11     1    11    27   643  3044\n12     1    12    28   921  2925\n13     1    13    36  1196  2867\n```\n:::\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -6.8451, df = 11, p-value = 2.782e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9699609 -0.6921361\nsample estimates:\n       cor \n-0.8999278 \n```\n:::\n:::\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-6_ea67c85af75beecde112d1766fd1f2eb'}\n\n```{.r .cell-code}\n#Experimento 2\n\nmofo1 <- mofo |> \n  filter (study ==2)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     2     1    76  1331  2257\n 2     2     2    44   756  2393\n 3     2     3    24   338  2401\n 4     2     4    33   581  2568\n 5     2     5    37   588  2320\n 6     2     6    34   231  2308\n 7     2     7    31   925  2389\n 8     2     8    16   119  2614\n 9     2     9    10   394  2681\n10     2    10     8   206  2694\n11     2    11    15   275  2674\n12     2    12     7   131  2666\n13     2    13    19   588  2454\n```\n:::\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -4.6638, df = 11, p-value = 0.0006894\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9426562 -0.4790750\nsample estimates:\n       cor \n-0.8149448 \n```\n:::\n:::\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-7_37d6ac1b51756e341f843e54fbb17384'}\n\n```{.r .cell-code}\n#Experimento 3\n\nmofo1 <- mofo |> \n  filter (study ==3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n:::\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -10.9, df = 11, p-value = 3.105e-07\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9872663 -0.8579544\nsample estimates:\n      cor \n-0.956692 \n```\n:::\n:::\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-8_31093dff10de18a0021107a8d2bfc8a1'}\n\n```{.r .cell-code}\n#Experimento 4\n\nmofo1 <- mofo |> \n  filter (study ==4)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     4     1    69  6216  1893\n 2     4     2    39  2888  2451\n 3     4     3    41  2272  2232\n 4     4     4    39  2868  2609\n 5     4     5    40  2412  2383\n 6     4     6    40  2372  2480\n 7     4     7    44  3424  2577\n 8     4     8    43  1744  2367\n 9     4     9    26  1456  2769\n10     4    10    29  1732  2907\n11     4    11    30  1080  2298\n12     4    12    34  1592  2976\n13     4    13    44  3268  2200\n```\n:::\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -3.7242, df = 11, p-value = 0.003357\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9194503 -0.3327077\nsample estimates:\n       cor \n-0.7467931 \n```\n:::\n:::\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-9_b9775f0b90b69e8cf4411c7b1efaaf18'}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -3.7242, df = 11, p-value = 0.003357\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9194503 -0.3327077\nsample estimates:\n       cor \n-0.7467931 \n```\n:::\n\n```{.r .cell-code}\npcor <- cor(mofo1 |> select(3:5))\nlibrary(corrplot)\ncorrplot (pcor, method = 'number', type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-10_5f0c22cd996726fcd701665c35a410b9'}\n\n```{.r .cell-code}\ncor.test(mofo$inc, mofo$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo$inc and mofo$yld\nt = -2.9274, df = 50, p-value = 0.005133\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.5934601 -0.1223842\nsample estimates:\n       cor \n-0.3825092 \n```\n:::\n\n```{.r .cell-code}\npcor <- cor(mofo |> select(3:5))\nlibrary(corrplot)\ncorrplot (pcor, method = 'number', type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='Aula-14_cache/html/unnamed-chunk-11_465d65ff1837fe2613120fd23fc4b3e2'}\n\n```{.r .cell-code}\nshapiro.test(mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mofo1$yld\nW = 0.97728, p-value = 0.9636\n```\n:::\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tSpearman's rank correlation rho\n\ndata:  mofo1$inc and mofo1$yld\nS = 611.02, p-value = 0.01077\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.6786265 \n```\n:::\n\n```{.r .cell-code}\npcor <- cor(mofo |> select(3:5))\nlibrary(corrplot)\ncorrplot (pcor, method = 'number', type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](Aula-14_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}